<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Criti.AI ì „ì²´ ì•„í‚¤í…ì²˜ - ìµœì¢… ë²„ì „</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap");
      body {
        font-family: "Noto Sans KR", sans-serif;
        background-color: #f8fafc;
      }
      .diagram-card {
        background-color: white;
        border-radius: 0.75rem;
        box-shadow:
          0 4px 6px -1px rgb(0 0 0 / 0.1),
          0 2px 4px -2px rgb(0 0 0 / 0.1);
        padding: 1.5rem;
        margin-bottom: 2rem;
        overflow: hidden;
      }
      h1,
      h2,
      h3 {
        font-weight: 700;
      }
      pre.mermaid {
        background-color: #f1f5f9;
        padding: 1rem;
        border-radius: 0.5rem;
        text-align: center;
      }
      code {
        background-color: #e2e8f0;
        padding: 0.2rem 0.4rem;
        border-radius: 0.25rem;
        font-size: 0.9em;
      }
      .key-feature {
        background-color: #f1f5f9;
        border-left: 4px solid #3b82f6;
        padding: 1rem;
        margin: 1rem 0;
        border-radius: 0.25rem;
      }
    </style>
  </head>
  <body class="p-4 sm:p-8">
    <div class="max-w-7xl mx-auto">
      <header class="text-center mb-12">
        <h1 class="text-4xl md:text-5xl font-bold text-gray-800">
          ğŸ—ï¸ Criti.AI ì•„í‚¤í…ì²˜ (ìµœì¢… ë²„ì „)
        </h1>
        <p class="text-lg text-gray-600 mt-2">
          ì‹œìŠ¤í…œ êµ¬ì¡°, ë°ì´í„° íë¦„, ìœ íŠœë¸Œ ë¶„ì„, ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜ ì•„í‚¤í…ì²˜
        </p>
        <p class="text-sm text-gray-500 mt-1">
          v2.0 - ìœ íŠœë¸Œ ë¶„ì„ & ë±ƒì§€ ì‹œìŠ¤í…œ í¬í•¨
        </p>
      </header>

      <!-- Document Part 1: Backend & Caching Focus -->
      <div class="mb-16">
        <h2
          class="text-3xl font-bold text-gray-800 border-b-2 border-blue-500 pb-2 mb-8"
        >
          ë°±ì—”ë“œ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
        </h2>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ›ï¸ 1. ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</h3>
          <pre class="mermaid">
graph TB
    subgraph "<b>Client Layer</b>"
        WEB["ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜<br/>React/Vite<br/>ì±Œë¦°ì§€ & ìœ íŠœë¸Œ ë¶„ì„"]
        EXT["Chrome<br/>í™•ì¥ í”„ë¡œê·¸ë¨<br/>ì‹¤ì‹œê°„ ê¸°ì‚¬ ë¶„ì„"]
        MOB["ëª¨ë°”ì¼ ì•±<br/>(í–¥í›„)"]
    end

    subgraph "<b>Network Layer</b>"
        LB["ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ<br/>Nginx"]
        CORS["CORS ì •ì±…<br/>Express Middleware"]
    end

    subgraph "<b>Application Layer</b>"
        API["Express.js API ì„œë²„<br/>TypeScript"]
        subgraph "<b>ë¼ìš°í„°</b>"
            AR["Analysis Router<br/>/api/analysis"]
            CR["Challenge Router<br/>/api/challenge"]
            YR["Youtube Router<br/>/api/youtube"]
            HR["Health Router<br/>/health"]
        end
        subgraph "<b>ì„œë¹„ìŠ¤</b>"
            GS["Gemini Service<br/>AI ë¶„ì„ ì—”ì§„"]
            YS["Youtube Service<br/>ìë§‰ ì¶”ì¶œ & ë©”íƒ€ë°ì´í„°"]
            DCS["Daily Challenge Service<br/>ìë™ ì±Œë¦°ì§€ ìƒì„±"]
            DS["Database Service<br/>ë°ì´í„° ê´€ë¦¬"]
            CS["Cache Service<br/>3ë‹¨ê³„ ìºì‹±"]
        end
    end

    subgraph "<b>Data Layer</b>"
        subgraph "<b>Cache Layer</b>"
            L1["L1: Redis Cache<br/>64MB LRU"]
            L2["L2: Database Cache<br/>ì˜êµ¬ ì €ì¥"]
            L3["L3: Memory Cache<br/>LRU 100ê°œ"]
        end
        subgraph "<b>ì˜êµ¬ ì €ì¥ì†Œ</b>"
            DB[("SQLite/PostgreSQL<br/>Prisma ORM")]
            FILES["íŒŒì¼ ì‹œìŠ¤í…œ<br/>ë¡œê·¸ & ì„ì‹œ íŒŒì¼"]
        end
    end

    subgraph "<b>ì™¸ë¶€ API</b>"
        GEMINI["Google Gemini AI<br/>ì½˜í…ì¸  ë¶„ì„"]
        YTAPI["YouTube Data API v3<br/>ë©”íƒ€ë°ì´í„° ìˆ˜ì§‘"]
        YTDLP["yt-dlp<br/>ìë§‰ ì¶”ì¶œ"]
    end

    subgraph "<b>ì¸í”„ë¼ ë ˆì´ì–´</b>"
        DOCKER["Docker ì»¨í…Œì´ë„ˆ<br/>Alpine Linux<br/>200MB Backend"]
        MONITOR["ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ<br/>ë©”ëª¨ë¦¬ & CPU<br/>ìë™ ì¬ì‹œì‘"]
        BACKUP["ë°±ì—… ì‹œìŠ¤í…œ<br/>ìë™ ë°±ì—…"]
        DEPLOY["ë°°í¬ ìë™í™”<br/>deploy-micro-auto.sh<br/>ìµœì í™” ìŠ¤í¬ë¦½íŠ¸"]
    end

    WEB --> LB
    EXT --> LB
    MOB --> LB
    LB --> CORS
    CORS --> API
    API --> AR
    API --> CR
    API --> YR
    API --> HR
    AR --> GS
    AR --> CS
    YR --> YS
    YR --> CS
    CR --> DCS
    CR --> DS
    CS --> L1
    CS --> L2
    CS --> L3
    DS --> DB
    GS --> GEMINI
    DCS --> GEMINI
    YS --> YTAPI
    YS --> YTDLP
    YS --> GS
    L2 --> DB
    DOCKER --> API
    MONITOR --> DOCKER
    BACKUP --> DB
    BACKUP --> FILES
    DEPLOY --> DOCKER

    classDef client fill:#e3f2fd
    classDef network fill:#f3e5f5
    classDef app fill:#e8f5e9
    classDef data fill:#fff3e0
    classDef external fill:#ffebee
    classDef infra fill:#f1f8e9
    
    class WEB,EXT,MOB client
    class LB,CORS network
    class API,AR,CR,YR,HR,GS,YS,DCS,DS,CS app
    class L1,L2,L3,DB,FILES data
    class GEMINI,YTAPI,YTDLP external
    class DOCKER,MONITOR,BACKUP,DEPLOY,HEALTHCHECK,LOGGING infra

    linkStyle default stroke-width:1px
                </pre>
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ¬ 2. ìœ íŠœë¸Œ ë¶„ì„ íŒŒì´í”„ë¼ì¸</h3>
          <pre class="mermaid">
graph TB
    subgraph "ğŸ“¥ ì‚¬ìš©ì ì…ë ¥"
        INPUT["ìœ íŠœë¸Œ URL ì…ë ¥<br/>challenge-web"]
    end

    subgraph "ğŸ” ë¹„ë””ì˜¤ ID ì¶”ì¶œ"
        VALIDATE["URL ê²€ì¦ & íŒŒì‹±<br/>ì •ê·œí‘œí˜„ì‹"]
        EXTRACT["ë¹„ë””ì˜¤ ID ì¶”ì¶œ<br/>ì˜ˆ: dQw4w9WgXcQ"]
    end

    subgraph "ğŸ“ ìë§‰ ì¶”ì¶œ (yt-dlp)"
        YTDLP_CHECK["yt-dlp ì‹¤í–‰ ê°€ëŠ¥ í™•ì¸"]
        YTDLP_CMD["yt-dlp ëª…ë ¹ì–´ ì‹¤í–‰<br/>--skip-download<br/>--write-auto-subs<br/>--sub-lang ko<br/>--sub-format json3"]
        SUBTITLE_PARSE["ìë§‰ íŒŒì¼ íŒŒì‹±<br/>JSON3 â†’ Segments"]
        SUBTITLE_CLEAN["í…ìŠ¤íŠ¸ ì •ë¦¬<br/>íƒ€ì„ìŠ¤íƒ¬í”„ ë§¤í•‘"]
    end

    subgraph "ğŸ“Š ë©”íƒ€ë°ì´í„° ìˆ˜ì§‘ (YouTube API)"
        API_CALL["YouTube Data API v3<br/>videos.list"]
        META_PARSE["ë©”íƒ€ë°ì´í„° íŒŒì‹±<br/>ì œëª©, ì„¤ëª…, ì±„ë„ëª…<br/>ì¡°íšŒìˆ˜, ì¢‹ì•„ìš”, ê²Œì‹œì¼"]
        CHANNEL_INFO["ì±„ë„ ì •ë³´ ìˆ˜ì§‘<br/>êµ¬ë…ì ìˆ˜, ì±„ë„ ìƒì„±ì¼"]
    end

    subgraph "ğŸ¤– AI ë¶„ì„"
        COMBINE["ìë§‰ + ë©”íƒ€ë°ì´í„° ê²°í•©<br/>ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±"]
        GEMINI_CALL["Gemini AI í˜¸ì¶œ<br/>ë‹¤ì°¨ì› ì‹ ë¢°ë„ ë¶„ì„<br/>- ì¶œì²˜ ì‹ ë¢°ë„<br/>- í¸í–¥ì„±<br/>- ë…¼ë¦¬ ì˜¤ë¥˜<br/>- ê´‘ê³ ì„±"]
        JSON_REPAIR["jsonrepair<br/>JSON ì‘ë‹µ ì•ˆì •í™”"]
        RESULT_VALIDATE["ê²°ê³¼ ê²€ì¦<br/>ìŠ¤í‚¤ë§ˆ í™•ì¸"]
    end

    subgraph "ğŸ’¾ ìºì‹± & ì‘ë‹µ"
        CACHE_SAVE["3-Tier ìºì‹±<br/>Redis + DB + Memory"]
        RESPONSE["ë¶„ì„ ê²°ê³¼ ë°˜í™˜<br/>YoutubeAnalysisPage"]
    end

    INPUT --> VALIDATE
    VALIDATE --> EXTRACT
    EXTRACT --> YTDLP_CHECK
    YTDLP_CHECK --> YTDLP_CMD
    YTDLP_CMD --> SUBTITLE_PARSE
    SUBTITLE_PARSE --> SUBTITLE_CLEAN
    EXTRACT --> API_CALL
    API_CALL --> META_PARSE
    META_PARSE --> CHANNEL_INFO
    SUBTITLE_CLEAN --> COMBINE
    CHANNEL_INFO --> COMBINE
    COMBINE --> GEMINI_CALL
    GEMINI_CALL --> JSON_REPAIR
    JSON_REPAIR --> RESULT_VALIDATE
    RESULT_VALIDATE --> CACHE_SAVE
    CACHE_SAVE --> RESPONSE

    classDef input fill:#e3f2fd
    classDef validate fill:#f3e5f5
    classDef ytdlp fill:#e8f5e9
    classDef ytapi fill:#fff3e0
    classDef ai fill:#ffebee
    classDef cache fill:#f1f8e9

    class INPUT input
    class VALIDATE,EXTRACT validate
    class YTDLP_CHECK,YTDLP_CMD,SUBTITLE_PARSE,SUBTITLE_CLEAN ytdlp
    class API_CALL,META_PARSE,CHANNEL_INFO ytapi
    class COMBINE,GEMINI_CALL,JSON_REPAIR,RESULT_VALIDATE ai
    class CACHE_SAVE,RESPONSE cache

    linkStyle default stroke-width:1px
                </pre>
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ”„ 3. ìœ íŠœë¸Œ ë¶„ì„ Sequence Diagram</h3>
          <pre class="mermaid">
sequenceDiagram
    participant U as ì‚¬ìš©ì
    participant W as ì›¹ í˜ì´ì§€
    participant API as Express API
    participant YS as YoutubeService
    participant YTDLP as yt-dlp
    participant YTAPI as YouTube API
    participant GS as GeminiService
    participant CACHE as Cache

    Note over U,CACHE: ğŸ¬ ìœ íŠœë¸Œ ì˜ìƒ ë¶„ì„ í”Œë¡œìš°

    U->>+W: ìœ íŠœë¸Œ URL ì…ë ¥
    W->>+API: POST /api/youtube/analyze<br/>{videoUrl}
    
    Note over API: ğŸ“ URL ê²€ì¦
    API->>API: validateVideoId()
    
    Note over API,CACHE: âš¡ ìºì‹œ í™•ì¸
    API->>+CACHE: ë¶„ì„ ê²°ê³¼ ì¡°íšŒ
    CACHE-->>-API: null (ìºì‹œ ë¯¸ìŠ¤)
    
    API->>+YS: extractTranscript(videoId)
    
    Note over YS,YTDLP: ğŸ“ ìë§‰ ì¶”ì¶œ (1-2ì´ˆ)
    YS->>+YTDLP: execFile(yt-dlp, args)
    YTDLP-->>-YS: subtitle.json3 íŒŒì¼
    YS->>YS: ìë§‰ íŒŒì‹± & ì •ë¦¬
    
    Note over YS,YTAPI: ğŸ“Š ë©”íƒ€ë°ì´í„° ìˆ˜ì§‘ (0.5ì´ˆ)
    YS->>+YTAPI: videos.list(videoId)
    YTAPI-->>-YS: {title, description, stats}
    YS->>+YTAPI: channels.list(channelId)
    YTAPI-->>-YS: {subscribers, created}
    
    YS-->>-API: {transcript, metadata}
    
    Note over API,GS: ğŸ¤– AI ë¶„ì„ (2-3ì´ˆ)
    API->>+GS: analyzeYoutubeVideo(data)
    GS->>GS: í”„ë¡¬í”„íŠ¸ êµ¬ì„±
    GS->>+GS: Gemini AI í˜¸ì¶œ
    GS-->>-GS: AI ì‘ë‹µ
    GS->>GS: jsonrepair(response)
    GS->>GS: ê²°ê³¼ ê²€ì¦
    GS-->>-API: analysisResult
    
    Note over API,CACHE: ğŸ’¾ ìºì‹±
    API->>CACHE: ê²°ê³¼ ì €ì¥ (24h TTL)
    
    API-->>-W: âœ… ë¶„ì„ ê²°ê³¼
    W-->>-U: ì‹ ë¢°ë„ ë¦¬í¬íŠ¸ í‘œì‹œ

    Note over U,CACHE: ğŸ“ˆ ì´ ì†Œìš” ì‹œê°„: ì•½ 1ë¶„
                </pre>
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">âš¡ 4. 3ë‹¨ê³„ ìºì‹± ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</h3>
          <pre class="mermaid">
graph TD
    subgraph "ğŸ“¥ ìš”ì²­ ì§„ì…ì "
        REQ[í´ë¼ì´ì–¸íŠ¸ ìš”ì²­<br/>ë¶„ì„ API í˜¸ì¶œ]
    end

    subgraph "ğŸƒâ€â™‚ï¸ L1: Redis ìºì‹œ (ì´ˆê³ ì†)"
        R1{Redis<br/>ìºì‹œ í™•ì¸}
        R2[Redis íˆíŠ¸<br/>âš¡ 5ms ì‘ë‹µ<br/>95% íˆíŠ¸ìœ¨]
        R3[Redisì— ì €ì¥<br/>TTL: 24ì‹œê°„<br/>64MB LRU]
    end

    subgraph "ğŸ’¾ L2: Database ìºì‹œ (ì¤‘ì†)"
        D1{Database<br/>ìºì‹œ í™•ì¸}
        D2[DB íˆíŠ¸<br/>ğŸ’¾ 50ms ì‘ë‹µ<br/>4% íˆíŠ¸ìœ¨]
        D3[DBì— ì˜êµ¬ ì €ì¥<br/>íˆíŠ¸ ì¹´ìš´íŠ¸ ì¦ê°€<br/>Prisma ORM]
    end

    subgraph "ğŸ§  L3: Memory ìºì‹œ (ìµœê³ ì†)"
        M1{Memory<br/>ìºì‹œ í™•ì¸}
        M2[Memory íˆíŠ¸<br/>ğŸ§  1ms ì‘ë‹µ]
        M3[Memoryì— ì €ì¥<br/>LRU ì •ì±…, 100ê°œ ì œí•œ]
    end

    subgraph "ğŸ¤– L4: AI ë¶„ì„ (ì €ì†)"
        A1[Gemini AI í˜¸ì¶œ<br/>ğŸ¤– 2500ms ì‘ë‹µ<br/>1% ë¯¸ìŠ¤ìœ¨]
        A2[ê²°ê³¼ ê²€ì¦<br/>JSON íŒŒì‹±<br/>jsonrepair]
    end

    REQ --> R1
    R1 -->|ìºì‹œ íˆíŠ¸| R2
    R1 -->|ìºì‹œ ë¯¸ìŠ¤| D1
    D1 -->|ìºì‹œ íˆíŠ¸| D2
    D1 -->|ìºì‹œ ë¯¸ìŠ¤| M1
    M1 -->|ìºì‹œ íˆíŠ¸| M2
    M1 -->|ìºì‹œ ë¯¸ìŠ¤| A1
    A1 --> A2
    A2 --> A3[ì „ì²´ ìºì‹œ ë ˆì´ì–´ ì €ì¥]
    A3 --> R3
    A3 --> D3
    A3 --> M3
    D2 --> R3

    classDef request fill:#e3f2fd
    classDef redis fill:#ffcdd2
    classDef database fill:#bbdefb
    classDef memory fill:#c8e6c9
    classDef ai fill:#ffecb3

    class REQ request
    class R1,R2,R3 redis
    class D1,D2,D3 database
    class M1,M2,M3 memory
    class A1,A2,A3 ai

    linkStyle default stroke-width:1px
                </pre>
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ® 5. ì¼ì¼ ì±Œë¦°ì§€ ìë™ ìƒì„± ì‹œìŠ¤í…œ</h3>
          <pre class="mermaid">
graph TB
    subgraph "â° ìŠ¤ì¼€ì¤„ë§ ì‹œìŠ¤í…œ"
        CRON[ë§¤ì¼ ìì • ì‹¤í–‰<br/>Node.js setTimeout]
        CHECK{ì˜¤ëŠ˜ ì±Œë¦°ì§€<br/>ì¡´ì¬ í™•ì¸}
    end

    subgraph "ğŸ¤– AI ì±Œë¦°ì§€ ìƒì„±"
        TEMPLATE[ì±Œë¦°ì§€ í…œí”Œë¦¿<br/>ë‚œì´ë„ë³„ 5ê°œ]
        subgraph "ë‚œì´ë„ë³„ ìƒì„±"
            BEG[ì´ˆê¸‰ ì±Œë¦°ì§€<br/>ë…¼ë¦¬ì  ì˜¤ë¥˜]
            INT1[ì¤‘ê¸‰ ì±Œë¦°ì§€<br/>ê´‘ê³ ì„± ì½˜í…ì¸ ]
            INT2[ì¤‘ê¸‰ ì±Œë¦°ì§€<br/>ì •ë³´ ì¶œì²˜]
            ADV[ê³ ê¸‰ ì±Œë¦°ì§€<br/>ë³µí•©ì  ë¬¸ì œ]
        end
        AI_GEN[Gemini AI<br/>í”„ë¡¬í”„íŠ¸ ê¸°ë°˜ ìƒì„±]
        VALIDATE[ê²°ê³¼ ê²€ì¦<br/>í’ˆì§ˆ í™•ì¸]
    end

    subgraph "ğŸ›¡ï¸ ë°±ì—… ì‹œìŠ¤í…œ"
        FALLBACK{AI ìƒì„±<br/>ì‹¤íŒ¨?}
        MANUAL[ìˆ˜ë™ ì‘ì„±<br/>ë°±ì—… ì±Œë¦°ì§€]
        BASIC[ê¸°ë³¸ ì±Œë¦°ì§€<br/>í•˜ë“œì½”ë”©]
    end

    subgraph "ğŸ’¾ ì €ì¥ ì‹œìŠ¤í…œ"
        DB_SAVE[(ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥<br/>dailyKeyë¡œ êµ¬ë¶„)]
        CACHE_SAVE[Redis ìºì‹±<br/>25ì‹œê°„ TTL]
    end
    
    CRON --> CHECK
    CHECK -->|ì¡´ì¬í•¨| RETURN[ê¸°ì¡´ ì±Œë¦°ì§€ ë°˜í™˜]
    CHECK -->|ì—†ìŒ| TEMPLATE
    TEMPLATE --> BEG
    TEMPLATE --> INT1
    TEMPLATE --> INT2
    TEMPLATE --> ADV
    BEG --> AI_GEN
    INT1 --> AI_GEN
    INT2 --> AI_GEN
    ADV --> AI_GEN
    AI_GEN --> VALIDATE
    VALIDATE -->|ì„±ê³µ| DB_SAVE
    VALIDATE -->|ì‹¤íŒ¨| FALLBACK
    FALLBACK -->|ì¬ì‹œë„| MANUAL
    FALLBACK -->|ìµœì¢… ì‹¤íŒ¨| BASIC
    MANUAL --> DB_SAVE
    BASIC --> DB_SAVE
    DB_SAVE --> CACHE_SAVE
    CACHE_SAVE --> COMPLETE[âœ… ìƒì„± ì™„ë£Œ]

    classDef schedule fill:#e3f2fd
    classDef ai fill:#f3e5f5
    classDef backup fill:#fff3e0
    classDef storage fill:#e8f5e9

    class CRON,CHECK schedule
    class TEMPLATE,BEG,INT1,INT2,ADV,AI_GEN,VALIDATE ai
    class FALLBACK,MANUAL,BASIC backup
    class DB_SAVE,CACHE_SAVE storage

    linkStyle default stroke-width:1px
                </pre>
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ† 6. ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜ & ë±ƒì§€ ì‹œìŠ¤í…œ</h3>
          <pre class="mermaid">
graph TB
    subgraph "ğŸ¯ ì‚¬ìš©ì ì§„ì…"
        START["ì‚¬ìš©ì ì ‘ì†<br/>challenge-web"]
        LOAD["localStorage ë¡œë“œ<br/>userId, stats"]
    end

    subgraph "ğŸ“Š ì‚¬ìš©ì ìƒíƒœ ê´€ë¦¬"
        USER_DATA["ì‚¬ìš©ì ë°ì´í„°<br/>- ì´ ì ìˆ˜<br/>- ì™„ë£Œí•œ ì±Œë¦°ì§€ ìˆ˜<br/>- íšë“ ë°°ì§€ ëª©ë¡<br/>- ë ˆë²¨"]
        LEVEL_CALC["ë ˆë²¨ ê³„ì‚°<br/>ì ìˆ˜ ê¸°ë°˜ ìë™ ì‚°ì •"]
    end

    subgraph "ğŸ® ì±Œë¦°ì§€ í”Œë ˆì´"
        CHALLENGE["ì±Œë¦°ì§€ ì‹œì‘"]
        ANSWER["ì •ë‹µ ì œì¶œ"]
        SCORE["ì ìˆ˜ ê³„ì‚°<br/>ê¸°ë³¸ì ìˆ˜ + ì‹œê°„ë³´ë„ˆìŠ¤<br/>+ íŒíŠ¸ë¯¸ì‚¬ìš©ë³´ë„ˆìŠ¤"]
    end

    subgraph "ğŸ† ë±ƒì§€ íšë“ ì‹œìŠ¤í…œ"
        BADGE_CHECK{ë±ƒì§€ ì¡°ê±´<br/>í™•ì¸}
        BADGE_NEW["ìƒˆ ë±ƒì§€ íšë“!<br/>- ì²« ì±Œë¦°ì§€ ì™„ë£Œ<br/>- 10íšŒ ì—°ì† ì •ë‹µ<br/>- 100ì  ë‹¬ì„±<br/>- ë ˆë²¨ 10 ë‹¬ì„±"]
        BADGE_ANIM["ë±ƒì§€ ì• ë‹ˆë©”ì´ì…˜<br/>ì¶•í•˜ íš¨ê³¼"]
    end

    subgraph "ğŸ’¾ ë°ì´í„° ì €ì¥"
        SAVE_LOCAL["localStorage ì €ì¥<br/>ì¦‰ì‹œ ë°˜ì˜"]
        SAVE_STATS["í†µê³„ ì—…ë°ì´íŠ¸<br/>- ì´ ì ìˆ˜<br/>- ì™„ë£Œ íšŸìˆ˜<br/>- ì •ë‹µë¥ "]
    end

    subgraph "ğŸ¨ UI ì—…ë°ì´íŠ¸"
        UPDATE_UI["UI ê°±ì‹ <br/>- ì ìˆ˜ í‘œì‹œ<br/>- ë ˆë²¨ ë°”<br/>- ë°°ì§€ ëª©ë¡"]
    end

    START --> LOAD
    LOAD --> USER_DATA
    USER_DATA --> LEVEL_CALC
    LEVEL_CALC --> CHALLENGE
    CHALLENGE --> ANSWER
    ANSWER --> SCORE
    SCORE --> BADGE_CHECK
    BADGE_CHECK -->|ì¡°ê±´ ì¶©ì¡±| BADGE_NEW
    BADGE_CHECK -->|ì¡°ê±´ ë¯¸ì¶©ì¡±| SAVE_LOCAL
    BADGE_NEW --> BADGE_ANIM
    BADGE_ANIM --> SAVE_LOCAL
    SAVE_LOCAL --> SAVE_STATS
    SAVE_STATS --> UPDATE_UI
    UPDATE_UI --> CHALLENGE

    classDef entry fill:#e3f2fd
    classDef state fill:#f3e5f5
    classDef play fill:#e8f5e9
    classDef badge fill:#fff3e0
    classDef storage fill:#ffebee
    classDef ui fill:#f1f8e9

    class START,LOAD entry
    class USER_DATA,LEVEL_CALC state
    class CHALLENGE,ANSWER,SCORE play
    class BADGE_CHECK,BADGE_NEW,BADGE_ANIM badge
    class SAVE_LOCAL,SAVE_STATS storage
    class UPDATE_UI ui

    linkStyle default stroke-width:1px
                </pre>
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ¯ í•µì‹¬ ì•„í‚¤í…ì²˜ íŠ¹ì§•</h3>
          <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="key-feature">
              <strong>1. í™•ì¥ì„± (Scalability):</strong> ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì¤€ë¹„,
              ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥í•œ ìºì‹±, ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ë°°í¬, Monorepo êµ¬ì¡°.
            </div>
            <div class="key-feature">
              <strong>2. ì„±ëŠ¥ (Performance):</strong> 3ë‹¨ê³„ ìºì‹±ìœ¼ë¡œ 95% ìš”ì²­
              ê³ ì† ì²˜ë¦¬, ìœ íŠœë¸Œ ë¶„ì„ 80% ë‹¨ì¶• (5ë¶„â†’1ë¶„), ë©”ëª¨ë¦¬ ìµœì í™”.
            </div>
            <div class="key-feature">
              <strong>3. ì•ˆì •ì„± (Reliability):</strong> ë‹¤ì¸µ ë°±ì—… ì‹œìŠ¤í…œ, ìë™
              ëª¨ë‹ˆí„°ë§ ë° ì¬ì‹œì‘, jsonrepairë¡œ AI ì‘ë‹µ ì•ˆì •í™”.
            </div>
            <div class="key-feature">
              <strong>4. ìœ ì§€ë³´ìˆ˜ì„± (Maintainability):</strong> ëª…í™•í•œ ê³„ì¸µ
              ë¶„ë¦¬, TypeScript íƒ€ì… ì•ˆì „ì„±, Shared íŒ¨í‚¤ì§€ë¡œ íƒ€ì… í†µí•©.
            </div>
            <div class="key-feature">
              <strong>5. ë¹„ìš© íš¨ìœ¨ì„± (Cost Efficiency):</strong> ìºì‹±ìœ¼ë¡œ AI API
              í˜¸ì¶œ 98% ì ˆì•½, Oracle Cloud Free Tier, Alpine Linux ê²½ëŸ‰í™”.
            </div>
            <div class="key-feature">
              <strong>6. ì‚¬ìš©ì ê²½í—˜ (UX):</strong> ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜ ì‹œìŠ¤í…œ, ë±ƒì§€
              & ë ˆë²¨, ì‹¤ì‹œê°„ í”¼ë“œë°±, ì§ê´€ì  UI/UX.
            </div>
          </div>
        </div>
      </div>

      <!-- Document Part 2: Monorepo & Frontend Focus -->
      <div>
        <h2
          class="text-3xl font-bold text-gray-800 border-b-2 border-green-500 pb-2 mb-8"
        >
          í”„ë¡œì íŠ¸ êµ¬ì¡° ë° ë°°í¬ ì•„í‚¤í…ì²˜
        </h2>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">
            ğŸŒ 1. ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ (High-Level Overview)
          </h3>
          <pre class="mermaid">
graph TB
    subgraph "<b>ğŸ¯ í´ë¼ì´ì–¸íŠ¸ ë ˆì´ì–´</b>"
        CHROME["ğŸ§© Chrome Extension<br/>ì‹¤ì‹œê°„ ê¸°ì‚¬ ë¶„ì„<br/>React + Vite"]
        WEB["ğŸŒ ì›¹ í”Œë«í¼<br/>ì±Œë¦°ì§€ & ìœ íŠœë¸Œ ë¶„ì„<br/>React SPA"]
        FUTURE["ğŸ“± ëª¨ë°”ì¼ ì•±<br/>(í–¥í›„ í™•ì¥)"]
    end

    subgraph "<b>ğŸ”— ê³µí†µ ë ˆì´ì–´</b>"
        SHARED["ğŸ”§ Shared Package<br/>ê³µí†µ íƒ€ì… & ìœ í‹¸ë¦¬í‹°<br/>TypeScript ì¸í„°í˜ì´ìŠ¤<br/>30+ íƒ€ì… ì •ì˜"]
    end

    subgraph "<b>ğŸ® ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆì´ì–´</b>"
        API["ğŸš€ Express.js API<br/>backend/<br/>TypeScript ì„œë²„"]
        
        subgraph "<b>ğŸ“ ë¼ìš°í„° (12ê°œ ì—”ë“œí¬ì¸íŠ¸)</b>"
            ROUTES["ğŸ›£ï¸ API ë¼ìš°íŒ…<br/>- /api/analysis<br/>- /api/challenge<br/>- /api/youtube<br/>- /health"]
        end
        
        subgraph "<b>âš™ï¸ í•µì‹¬ ì„œë¹„ìŠ¤</b>"
            GEMINI["ğŸ¤– Gemini Service<br/>AI ë¶„ì„ ì—”ì§„"]
            YOUTUBE["ğŸ¬ Youtube Service<br/>ìë§‰ & ë©”íƒ€ë°ì´í„°"]
            CACHE["âš¡ Cache Service<br/>3-Tier ìºì‹±"]
            DB_SVC["ğŸ’¾ Database Service<br/>ë°ì´í„° ì˜ì†ì„±"]
            CHALLENGE["ğŸ¯ Challenge Service<br/>ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜"]
        end
    end

    subgraph "<b>ğŸ“Š ë°ì´í„° ë ˆì´ì–´</b>"
        subgraph "<b>ğŸ—„ï¸ ì˜êµ¬ ì €ì¥ì†Œ</b>"
            PRISMA[("ğŸ”· Prisma ORM<br/>schema.prisma<br/>íƒ€ì… ì•ˆì „ DB<br/>SQLite/PostgreSQL")]
            REDIS[("âš¡ Redis Cache<br/>ê³ ì† ìºì‹±<br/>64MB LRU")]
        end
    end

    subgraph "<b>ğŸŒ ì™¸ë¶€ API</b>"
        GEMINI_API["ğŸ”® Google Gemini AI<br/>ì½˜í…ì¸  ë¶„ì„ & ìƒì„±"]
        YTAPI["ğŸ“º YouTube Data API v3<br/>ë©”íƒ€ë°ì´í„° ìˆ˜ì§‘"]
        YTDLP_EXT["ğŸ“ yt-dlp<br/>ìë§‰ ì¶”ì¶œ ë„êµ¬"]
    end

    subgraph "<b>ğŸ—ï¸ ì¸í”„ë¼ ë ˆì´ì–´</b>"
        DOCKER["ğŸ³ Docker<br/>ì»¨í…Œì´ë„ˆí™”<br/>Alpine Linux<br/>Multi-stage Build"]
        NGINX["ğŸ”€ Nginx<br/>ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ<br/>ë¡œë“œ ë°¸ëŸ°ì‹±"]
        SCRIPTS["ğŸš€ DevOps Scripts<br/>ìë™í™” ë°°í¬<br/>ëª¨ë‹ˆí„°ë§ & ìµœì í™”"]
    end

    subgraph "<b>â˜ï¸ ë°°í¬ í™˜ê²½</b>"
        VERCEL["â–² Vercel<br/>ì›¹ í”Œë«í¼ í˜¸ìŠ¤íŒ…<br/>ë¬´ë£Œ í‹°ì–´"]
        ORACLE["â˜ï¸ Oracle Cloud<br/>Micro Instance<br/>1GB RAM<br/>API & DB í˜¸ìŠ¤íŒ…"]
    end

    CHROME --> SHARED
    WEB --> SHARED
    FUTURE -.-> SHARED
    SHARED --> API
    API --> ROUTES
    ROUTES --> GEMINI
    ROUTES --> YOUTUBE
    ROUTES --> CACHE
    ROUTES --> DB_SVC
    ROUTES --> CHALLENGE
    DB_SVC --> PRISMA
    CACHE --> REDIS
    GEMINI --> GEMINI_API
    YOUTUBE --> YTAPI
    YOUTUBE --> YTDLP_EXT
    YOUTUBE --> GEMINI
    CHALLENGE --> GEMINI_API
    DOCKER --> API
    NGINX --> API
    SCRIPTS --> DOCKER
    SCRIPTS --> NGINX
    WEB --> VERCEL
    CHROME --> VERCEL
    API --> ORACLE
    PRISMA --> ORACLE
    REDIS --> ORACLE

    classDef client fill:#e3f2fd
    classDef shared fill:#f3e5f5
    classDef app fill:#e8f5e9
    classDef data fill:#fff3e0
    classDef external fill:#ffebee
    classDef infra fill:#f1f8e9
    classDef deploy fill:#fce4ec

    class CHROME,WEB,FUTURE client
    class SHARED shared
    class API,ROUTES,GEMINI,YOUTUBE,CACHE,DB_SVC,CHALLENGE app
    class PRISMA,REDIS data
    class GEMINI_API,YTAPI,YTDLP_EXT external
    class DOCKER,NGINX,SCRIPTS infra
    class VERCEL,ORACLE deploy

    linkStyle default stroke-width:1px
                </pre>
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ¢ 2. Monorepo êµ¬ì¡°ë„</h3>
          <pre class="mermaid">
graph TD
    subgraph "Criti AI Monorepo"
        Root["ë£¨íŠ¸ package.json<br/>- workspaces ì„¤ì •<br/>- í†µí•© ìŠ¤í¬ë¦½íŠ¸<br/>- npm workspaces"]
        
        subgraph "Frontend Apps"
            Extension["chrome-extension/<br/>Chrome Extension<br/>React + Vite + @crxjs<br/>Shadow DOM"]
            Web["challenge-web/<br/>React SPA<br/>Vite + Emotion<br/>ì±Œë¦°ì§€ & ìœ íŠœë¸Œ ë¶„ì„"]
        end
        
        subgraph "Backend"
            Backend["backend/<br/>Express.js API<br/>TypeScript<br/>Prisma ORM"]
        end
        
        subgraph "Shared Resources"
            Shared["shared/<br/>ê³µí†µ íƒ€ì…/ìœ í‹¸<br/>30+ ì¸í„°í˜ì´ìŠ¤<br/>@criti-ai/shared"]
            Config["config/<br/>Docker & Nginx<br/>ë°°í¬ ì„¤ì •"]
            Scripts["scripts/<br/>ë°°í¬ ìë™í™”<br/>ëª¨ë‹ˆí„°ë§"]
        end
    end
    
    Extension --> Shared
    Web --> Shared
    Backend --> Shared
    Root --> Extension
    Root --> Web
    Root --> Backend
    Root --> Shared

    classDef root fill:#f8bbd0
    classDef frontend fill:#bbdefb
    classDef backend fill:#ffccbc
    classDef shared fill:#c8e6c9

    class Root root
    class Extension,Web frontend
    class Backend backend
    class Shared,Config,Scripts shared

    linkStyle default stroke-width:1px
                </pre>
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸš€ 3. ë°°í¬ ë° ì¸í”„ë¼ êµ¬ì¡°</h3>
          <pre class="mermaid">
graph TB
    subgraph "ê°œë°œ í™˜ê²½"
        Dev["ë¡œì»¬ ê°œë°œ<br/>npm run dev:full<br/>Backend + Frontend ë™ì‹œ ì‹¤í–‰"]
        Testing["í…ŒìŠ¤íŠ¸ í™˜ê²½<br/>TypeScript íƒ€ì… ì²´í¬"]
    end

    subgraph "GitHub Repository"
        Main["main ë¸Œëœì¹˜<br/>í”„ë¡œë•ì…˜ ë°°í¬"]
        Develop["develop ë¸Œëœì¹˜<br/>ê°œë°œ í†µí•©"]
        Feature["feature/* ë¸Œëœì¹˜<br/>ê¸°ëŠ¥ ê°œë°œ"]
    end

    subgraph "CI/CD Pipeline"
        Actions["GitHub Actions<br/>- íƒ€ì… ì²´í¬<br/>- ë¦°íŠ¸<br/>- ë¹Œë“œ í…ŒìŠ¤íŠ¸"]
        VercelCI["Vercel CI/CD<br/>- ìë™ ë°°í¬<br/>- í”„ë¦¬ë·° ë°°í¬"]
    end

    subgraph "Production Deployment"
        VercelProd["Vercel Production<br/>challenge-web ë°°í¬<br/>Global CDN"]
        Oracle["Oracle Cloud<br/>Backend API<br/>1GB RAM ìµœì í™”<br/>Docker Compose"]
        CDN["Static Assets<br/>ì •ì  ìì‚° CDN"]
    end

    subgraph "ëª¨ë‹ˆí„°ë§ & ë°±ì—…"
        Monitor["ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ<br/>ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ <br/>ìë™ ì¬ì‹œì‘"]
        Backup["ë°±ì—… ì‹œìŠ¤í…œ<br/>DB ë°±ì—…<br/>ë¡œê·¸ ê´€ë¦¬"]
    end

    Dev --> Feature
    Feature --> Develop
    Develop --> Main
    Main --> Actions
    Actions --> VercelCI
    VercelCI --> VercelProd
    Main --> Oracle
    VercelProd --> CDN
    Oracle --> Monitor
    Oracle --> Backup

    classDef dev fill:#e3f2fd
    classDef git fill:#f3e5f5
    classDef cicd fill:#e8f5e9
    classDef prod fill:#fff3e0
    classDef ops fill:#ffebee

    class Dev,Testing dev
    class Main,Develop,Feature git
    class Actions,VercelCI cicd
    class VercelProd,Oracle,CDN prod
    class Monitor,Backup ops

    linkStyle default stroke-width:1px
                </pre>
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ“± 4. Chrome Extension ì•„í‚¤í…ì²˜</h3>
          <pre class="mermaid">
graph TB
    subgraph "ì›¹ í˜ì´ì§€"
        WEBPAGE["ë‰´ìŠ¤ ê¸°ì‚¬<br/>ì‚¬ìš©ìê°€ ë°©ë¬¸í•œ í˜ì´ì§€"]
    end

    subgraph "Chrome Extension"
        subgraph "Content Script"
            CS["Content Script<br/>í˜ì´ì§€ì— ì£¼ì…<br/>Shadow DOM ê²©ë¦¬"]
            SIDEBAR["ë¶„ì„ ì‚¬ì´ë“œë°”<br/>TrustMeter<br/>BiasHighlights<br/>LogicalFallacies"]
            HIGHLIGHT["í…ìŠ¤íŠ¸ í•˜ì´ë¼ì´íŒ…<br/>ë¬¸ì œ ë¬¸ì¥ í‘œì‹œ"]
        end
        
        subgraph "Background Script"
            BG["Background Script<br/>Service Worker<br/>API Proxy ì—­í• "]
        end
        
        subgraph "Popup"
            POPUP["í™•ì¥ í”„ë¡œê·¸ë¨ íŒì—…<br/>ì„¤ì • & ìƒíƒœ"]
        end
    end

    subgraph "Backend API"
        API_SERVER["Express API<br/>/api/analysis/analyze"]
    end

    WEBPAGE --> CS
    CS --> SIDEBAR
    CS --> HIGHLIGHT
    CS -->|chrome.runtime<br/>sendMessage| BG
    POPUP -->|chrome.runtime<br/>sendMessage| BG
    BG -->|fetch API<br/>CORS ìš°íšŒ| API_SERVER
    API_SERVER -->|ë¶„ì„ ê²°ê³¼| BG
    BG -->|sendResponse| CS
    BG -->|sendResponse| POPUP

    classDef webpage fill:#e3f2fd
    classDef content fill:#f3e5f5
    classDef background fill:#e8f5e9
    classDef popup fill:#fff3e0
    classDef api fill:#ffebee

    class WEBPAGE webpage
    class CS,SIDEBAR,HIGHLIGHT content
    class BG background
    class POPUP popup
    class API_SERVER api

    linkStyle default stroke-width:1px
                </pre>
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ® 5. ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜ ìƒíƒœ ë¨¸ì‹ </h3>
          <pre class="mermaid">
stateDiagram-v2
    [*] --> UserIdentification

    UserIdentification --> LoadProgress: ê¸°ì¡´ ì‚¬ìš©ì
    UserIdentification --> CreateUser: ì‹ ê·œ ì‚¬ìš©ì

    CreateUser --> InitialChallenge
    LoadProgress --> ChallengeSelection
    InitialChallenge --> ChallengeInProgress
    ChallengeSelection --> ChallengeInProgress

    state ChallengeInProgress {
        [*] --> ReadingChallenge
        ReadingChallenge --> SelectingAnswers
        SelectingAnswers --> SubmittingAnswer
    }

    ChallengeInProgress --> ResultEvaluation

    state ResultEvaluation {
        [*] --> ScoreCalculation
        ScoreCalculation --> BadgeCheck
        BadgeCheck --> StatUpdate
        StatUpdate --> [*]
    }

    ResultEvaluation --> BadgeAnimation: ìƒˆ ë°°ì§€ íšë“
    ResultEvaluation --> NextChallenge: ì¼ë°˜ ì™„ë£Œ

    BadgeAnimation --> NextChallenge
    NextChallenge --> ChallengeSelection

    note right of UserIdentification
        localStorage ê¸°ë°˜
        ë¸Œë¼ìš°ì €ë³„ ê³ ìœ  ID
        ì˜¤í”„ë¼ì¸ ë™ì‘
    end note
    
    note right of ScoreCalculation
        ê¸°ë³¸ ì ìˆ˜ (100ì )
        + ì‹œê°„ ë³´ë„ˆìŠ¤
        + íŒíŠ¸ ë¯¸ì‚¬ìš© ë³´ë„ˆìŠ¤
        = ìµœì¢… ì ìˆ˜
    end note

    note right of BadgeCheck
        ë°°ì§€ ì¡°ê±´:
        - ì²« ì±Œë¦°ì§€ ì™„ë£Œ
        - 10íšŒ ì—°ì† ì •ë‹µ
        - 100ì  ë‹¬ì„±
        - ë ˆë²¨ 10 ë„ë‹¬
    end note
                </pre
          >
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ¨ 6. ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜</h3>
          <pre class="mermaid">
graph TD
    subgraph "App Layer"
        App["App.tsx<br/>ë¼ìš°íŒ… & ì „ì—­ ìƒíƒœ"]
    end
    
    subgraph "Page Layer"
        ChallengePage["ChallengePage.tsx<br/>ì±Œë¦°ì§€ ê²Œì„"]
        YoutubePage["YoutubeAnalysisPage.tsx<br/>ìœ íŠœë¸Œ ë¶„ì„"]
    end
    
    subgraph "Container Components"
        Header["Header<br/>ë„¤ë¹„ê²Œì´ì…˜"]
        StatsBar["StatsBar<br/>ì ìˆ˜/ë ˆë²¨/ë°°ì§€"]
        ChallengeCard["ChallengeCard<br/>ë¬¸ì œ í‘œì‹œ"]
        Result["Result<br/>ê²°ê³¼ & í•´ì„¤"]
        YoutubeForm["YoutubeForm<br/>URL ì…ë ¥"]
        AnalysisResult["AnalysisResult<br/>ë¶„ì„ ë¦¬í¬íŠ¸"]
    end
    
    subgraph "UI Components"
        Button["Button"]
        OptionButton["OptionButton"]
        Badge["Badge<br/>ë±ƒì§€ í‘œì‹œ"]
        Progress["Progress Bar<br/>ë ˆë²¨ ì§„í–‰ë„"]
        TrustMeter["TrustMeter<br/>ì‹ ë¢°ë„ ê²Œì´ì§€"]
    end
    
    subgraph "Service & State"
        ApiService["ApiService<br/>API í†µì‹ "]
        UserService["UserService<br/>ì‚¬ìš©ì ê´€ë¦¬"]
        LocalStorage["LocalStorage<br/>ë°ì´í„° ì˜ì†í™”"]
    end
    
    App --> ChallengePage
    App --> YoutubePage
    ChallengePage --> Header
    ChallengePage --> StatsBar
    ChallengePage --> ChallengeCard
    ChallengePage --> Result
    YoutubePage --> YoutubeForm
    YoutubePage --> AnalysisResult
    ChallengeCard --> Button
    ChallengeCard --> OptionButton
    StatsBar --> Progress
    StatsBar --> Badge
    Result --> Badge
    AnalysisResult --> TrustMeter
    ChallengePage --> ApiService
    ChallengePage --> UserService
    YoutubePage --> ApiService
    UserService --> LocalStorage

    classDef app fill:#f8bbd0
    classDef page fill:#bbdefb
    classDef container fill:#ffccbc
    classDef ui fill:#c8e6c9
    classDef service fill:#d1c4e9

    class App app
    class ChallengePage,YoutubePage page
    class Header,StatsBar,ChallengeCard,Result,YoutubeForm,AnalysisResult container
    class Button,OptionButton,Badge,Progress,TrustMeter ui
    class ApiService,UserService,LocalStorage service

    linkStyle default stroke-width:1px
                </pre>
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ“Š 7. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ (Prisma)</h3>
          <pre class="mermaid">
erDiagram
    AnalysisCache ||--o{ Analysis : "stores"
    DailyChallenge ||--o{ Challenge : "generates"
    UserProgress ||--o{ User : "tracks"

    AnalysisCache {
        string id PK
        string url UK
        string urlHash UK
        string title
        string publisher
        json result
        datetime createdAt
        datetime updatedAt
        int hitCount
    }

    DailyChallenge {
        string id PK
        string dailyKey UK
        json challenges
        datetime createdAt
    }

    UserProgress {
        string id PK
        string userId UK
        int totalScore
        int completedChallenges
        json badges
        int level
        datetime lastActive
    }

    Analysis {
        int trustScore
        string trustLevel
        json sourceCredibility
        json biasAnalysis
        json logicalFallacies
        json adDetection
    }

    Challenge {
        string id
        string type
        string difficulty
        string title
        string content
        json options
        int correctAnswer
        string explanation
    }

    User {
        string userId
        string username
        datetime createdAt
    }
                </pre
          >
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ”§ 8. í•µì‹¬ ê¸°ìˆ  í†µí•© íë¦„</h3>
          <pre class="mermaid">
graph TB
    subgraph "ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤"
        UI1["Chrome Extension<br/>ì‹¤ì‹œê°„ ë¶„ì„"]
        UI2["ì›¹ í”Œë«í¼<br/>ì±Œë¦°ì§€ & ìœ íŠœë¸Œ"]
    end

    subgraph "API Gateway"
        NGINX_LAYER["Nginx<br/>ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ<br/>Rate Limiting"]
    end

    subgraph "ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§"
        ROUTER["Express Router<br/>ìš”ì²­ ë¶„ë°°"]
        SERVICE["Service Layer<br/>í•µì‹¬ ë¡œì§"]
    end

    subgraph "AI & ì™¸ë¶€ ì—°ë™"
        GEMINI_LAYER["Gemini Service<br/>AI ë¶„ì„"]
        YOUTUBE_LAYER["Youtube Service<br/>ìë§‰ & ë©”íƒ€"]
        CACHE_LAYER["Cache Service<br/>3-Tier"]
    end

    subgraph "ë°ì´í„° ì˜ì†í™”"
        DB_LAYER["Prisma ORM<br/>SQLite/PostgreSQL"]
        REDIS_LAYER["Redis<br/>ìºì‹œ ìŠ¤í† ì–´"]
    end

    subgraph "ì™¸ë¶€ API"
        EXTERNAL["Gemini AI<br/>YouTube API<br/>yt-dlp"]
    end

    UI1 --> NGINX_LAYER
    UI2 --> NGINX_LAYER
    NGINX_LAYER --> ROUTER
    ROUTER --> SERVICE
    SERVICE --> GEMINI_LAYER
    SERVICE --> YOUTUBE_LAYER
    SERVICE --> CACHE_LAYER
    GEMINI_LAYER --> EXTERNAL
    YOUTUBE_LAYER --> EXTERNAL
    CACHE_LAYER --> REDIS_LAYER
    CACHE_LAYER --> DB_LAYER
    SERVICE --> DB_LAYER

    classDef ui fill:#e3f2fd
    classDef gateway fill:#f3e5f5
    classDef logic fill:#e8f5e9
    classDef ai fill:#fff3e0
    classDef data fill:#ffebee
    classDef external fill:#f1f8e9

    class UI1,UI2 ui
    class NGINX_LAYER gateway
    class ROUTER,SERVICE logic
    class GEMINI_LAYER,YOUTUBE_LAYER,CACHE_LAYER ai
    class DB_LAYER,REDIS_LAYER data
    class EXTERNAL external

    linkStyle default stroke-width:1px
                </pre>
        </div>

        <div class="diagram-card">
          <h3 class="text-2xl mb-4">ğŸ’¡ ì‹œìŠ¤í…œ í•µì‹¬ ê°•ì </h3>
          <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="key-feature">
              <strong>1. ì„±ëŠ¥ ìµœì í™”:</strong>
              <ul class="mt-2 space-y-1 text-sm">
                <li>â€¢ 3-Tier ìºì‹±ìœ¼ë¡œ 95% íˆíŠ¸ìœ¨</li>
                <li>â€¢ ìœ íŠœë¸Œ ë¶„ì„ 80% ë‹¨ì¶• (5ë¶„â†’1ë¶„)</li>
                <li>â€¢ Alpine Linux ê²½ëŸ‰í™” (ì´ë¯¸ì§€ 70% ì••ì¶•)</li>
                <li>â€¢ Node.js í™ ë©”ëª¨ë¦¬ 128MB ì œí•œ</li>
              </ul>
            </div>
            <div class="key-feature">
              <strong>2. ë¹„ìš© íš¨ìœ¨ì„±:</strong>
              <ul class="mt-2 space-y-1 text-sm">
                <li>â€¢ Oracle Cloud Free Tier ($0/ì›”)</li>
                <li>â€¢ Vercel Free Tier ($0/ì›”)</li>
                <li>â€¢ AI API í˜¸ì¶œ 98% ì ˆê° (ìºì‹±)</li>
                <li>â€¢ ì´ ìš´ì˜ ë¹„ìš©: ~$1/ì›”</li>
              </ul>
            </div>
            <div class="key-feature">
              <strong>3. ê°œë°œ ìƒì‚°ì„±:</strong>
              <ul class="mt-2 space-y-1 text-sm">
                <li>â€¢ Monorepoë¡œ íƒ€ì… í†µí•©</li>
                <li>â€¢ Shared Package 30+ íƒ€ì…</li>
                <li>â€¢ TypeScript 100% ì»¤ë²„ë¦¬ì§€</li>
                <li>â€¢ ëŸ°íƒ€ì„ ì—ëŸ¬ ì œë¡œ (ì»´íŒŒì¼ ê²€ì¶œ)</li>
              </ul>
            </div>
            <div class="key-feature">
              <strong>4. ì•ˆì •ì„±:</strong>
              <ul class="mt-2 space-y-1 text-sm">
                <li>â€¢ jsonrepairë¡œ AI ì‘ë‹µ ì•ˆì •í™”</li>
                <li>â€¢ Fallback ì±Œë¦°ì§€ ì‹œìŠ¤í…œ</li>
                <li>â€¢ Healthcheck & ìë™ ì¬ì‹œì‘</li>
                <li>â€¢ ë©”ëª¨ë¦¬ ëª¨ë‹ˆí„°ë§ (85% ì´í•˜ ìœ ì§€)</li>
              </ul>
            </div>
            <div class="key-feature">
              <strong>5. ì‚¬ìš©ì ê²½í—˜:</strong>
              <ul class="mt-2 space-y-1 text-sm">
                <li>â€¢ ì‹¤ì‹œê°„ ê¸°ì‚¬ ë¶„ì„ (Shadow DOM)</li>
                <li>â€¢ ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜ (ë±ƒì§€/ë ˆë²¨)</li>
                <li>â€¢ ìœ íŠœë¸Œ ìë§‰ ê¸°ë°˜ ë¶„ì„</li>
                <li>â€¢ ì§ê´€ì  ì‹ ë¢°ë„ ì‹œê°í™”</li>
              </ul>
            </div>
            <div class="key-feature">
              <strong>6. í™•ì¥ì„±:</strong>
              <ul class="mt-2 space-y-1 text-sm">
                <li>â€¢ Docker ì»¨í…Œì´ë„ˆí™”</li>
                <li>â€¢ ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜</li>
                <li>â€¢ SQLite â†’ PostgreSQL ë§ˆì´ê·¸ë ˆì´ì…˜ ì¤€ë¹„</li>
                <li>â€¢ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì „í™˜ ìš©ì´</li>
              </ul>
            </div>
          </div>
        </div>

       
    <footer class="text-center py-8 text-gray-500 text-sm">
      <p>Criti.AI Architecture Documentation v2.0</p>
      <p class="mt-2">
        ìœ íŠœë¸Œ ë¶„ì„ & ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜ ì‹œìŠ¤í…œ í¬í•¨ | ìµœì¢… ì—…ë°ì´íŠ¸: 2024.11
      </p>
    </footer>

    <script>
      mermaid.initialize({
        startOnLoad: true,
        theme: "neutral",
        themeVariables: {
          fontSize: "14px",
        },
        flowchart: {
          curve: "basis",
          useMaxWidth: true,
          htmlLabels: true,
        },
      });
    </script>
  </body>
</html>
